import{s as Q,f as d,a as H,g as f,h as S,B as P,c as B,d as E,j as l,i as W,u,L as j,E as U,V as X,y as J,C as Y,J as Z,o as ee}from"./scheduler.009eed4a.js";import{S as te,i as ae}from"./index.cf223af7.js";import{w as q}from"./index.2058b505.js";var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function se(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var D={exports:{}},K;function re(){return K||(K=1,function(i,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof $<"u")return $;throw new Error("unable to locate global object")},a=t();i.exports=e=a.fetch,a.fetch&&(e.default=a.fetch.bind(a)),e.Headers=a.Headers,e.Request=a.Request,e.Response=a.Response}(D,D.exports)),D.exports}let L;typeof window<"u"?L=window.fetch:L=re();class ie{constructor(e,t){this._redirect_in_unauthorized_internal=t,this._basic_authentication={},this._bearer_authentication,this._url=e,this._defaultHeaders=new Map}SetBasicAuthentication(e,t){return e&&t?this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"):this._basic_authentication=void 0,this}setBasicAuthorization(e,t){return e&&t?this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"):this._basic_authentication=void 0,this}setBearerAuthorization(e){return e?this._bearer_authentication="Bearer "+e:this._bearer_authentication=void 0,this}_addAuthorizationHeader(e){return this._basic_authentication&&(e.Authorization=this._basic_authentication),this._bearer_authentication&&(e.Authorization=this._bearer_authentication),e}addHeader(e,t){this._defaultHeaders.set(e,t)}async request(e,t,a,n){let s,r=t?t.toUpperCase():"GET",c=e&&e.length>0?e:this._url;if(!(r=="GET"||r=="POST"||r=="HEAD"||r=="PUT"||r=="DELETE"||r=="CONNECT"||r=="OPTIONS"||r=="TRACE"||r=="PATCH"))throw"Invalid method";n||(n={"Content-Type":"application/json"}),n=this._addAuthorizationHeader(n);for(const[h,w]of this._defaultHeaders)n[h]=w;try{switch(r){case"POST":s=await L(c,{method:r,body:JSON.stringify(a),headers:n});break;case"PUT":s=await L(c,{method:r,body:JSON.stringify(a),headers:n});break;default:let h=new URLSearchParams(a);c=c+"?"+h.toString(),s=await L(c,{method:r,headers:n});break}return this._redirect_in_unauthorized&&s.status==401&&(window.location.href=this._redirect_in_unauthorized),s}catch(h){if(console.log(h),s)return s;throw h}}async put(e,t,a){return this.request(e,"PUT",t,a)}async delete(e,t,a){return this.request(e,"DELETE",t,a)}async post(e,t,a){return this.request(e,"POST",t,a)}async get(e,t,a){return this.request(e,"GET",t,a)}async patch(e,t,a){return this.request(e,"PATCH",t,a)}}var ne=ie;const I=se(ne),oe=q({}),le=q({}),ue=q({}),ce=q({}),ye=q({}),me=i=>JSON.stringify(i,null,2).replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;"),we=async(i,e)=>{let t=new I;t.setBearerAuthorization(i);try{let n=await(await t.get("/system/main/functions",{appName:e})).json();if(n&&Array.isArray(n)){let s=n.map(r=>({id:r,value:r}));ce.set(s)}}catch(a){console.error(a)}},de=async i=>{let e=new I;e.setBearerAuthorization(i);try{let a=await(await e.get("/system/main/handlers")).json();if(a&&Array.isArray(a)){let n=a.map(s=>({id:s.handler,value:s.label,enabled:s.enabled,description:s.description}));ue.set(n)}}catch(t){console.error(t)}},fe=async i=>{let e=new I;e.setBearerAuthorization(i);try{let a=await(await e.get("/system/main/methods")).json();if(a&&Array.isArray(a)){let n=a.map(s=>({id:s.method,value:s.label,enabled:s.enabled,description:""}));le.set(n)}}catch(t){console.error(t)}};function he(i){let e,t,a="Iniciar sesión",n,s,r,c,h="Nombre de usuario",w,y,o,_,m,g,V="Contraseña",N,A,p,R,C,x='<div class="control"><button class="button is-primary" type="submit">Iniciar sesión</button></div>',M,F;return{c(){e=d("div"),t=d("h1"),t.textContent=a,n=H(),s=d("form"),r=d("div"),c=d("label"),c.textContent=h,w=H(),y=d("div"),o=d("input"),_=H(),m=d("div"),g=d("label"),g.textContent=V,N=H(),A=d("div"),p=d("input"),R=H(),C=d("div"),C.innerHTML=x,this.h()},l(b){e=f(b,"DIV",{class:!0});var v=S(e);t=f(v,"H1",{class:!0,"data-svelte-h":!0}),P(t)!=="svelte-1yeihy2"&&(t.textContent=a),n=B(v),s=f(v,"FORM",{class:!0});var T=S(s);r=f(T,"DIV",{class:!0});var z=S(r);c=f(z,"LABEL",{class:!0,"data-svelte-h":!0}),P(c)!=="svelte-1tq2mwz"&&(c.textContent=h),w=B(z),y=f(z,"DIV",{class:!0});var k=S(y);o=f(k,"INPUT",{class:!0,type:!0,placeholder:!0}),k.forEach(E),z.forEach(E),_=B(T),m=f(T,"DIV",{class:!0});var O=S(m);g=f(O,"LABEL",{class:!0,"data-svelte-h":!0}),P(g)!=="svelte-66z98u"&&(g.textContent=V),N=B(O),A=f(O,"DIV",{class:!0});var G=S(A);p=f(G,"INPUT",{class:!0,type:!0,placeholder:!0}),G.forEach(E),O.forEach(E),R=B(T),C=f(T,"DIV",{class:!0,"data-svelte-h":!0}),P(C)!=="svelte-u84jsi"&&(C.innerHTML=x),T.forEach(E),v.forEach(E),this.h()},h(){l(t,"class","title is-4"),l(c,"class","label"),l(o,"class","input"),l(o,"type","text"),l(o,"placeholder","Nombre de usuario"),o.required=!0,l(y,"class","control"),l(r,"class","field"),l(g,"class","label"),l(p,"class","input"),l(p,"type","password"),l(p,"placeholder","Contraseña"),p.required=!0,l(A,"class","control"),l(m,"class","field"),l(C,"class","field"),l(s,"class","form svelte-osrx57"),l(e,"class","container svelte-osrx57")},m(b,v){W(b,e,v),u(e,t),u(e,n),u(e,s),u(s,r),u(r,c),u(r,w),u(r,y),u(y,o),j(o,i[0]),u(s,_),u(s,m),u(m,g),u(m,N),u(m,A),u(A,p),j(p,i[1]),u(s,R),u(s,C),M||(F=[U(o,"input",i[3]),U(p,"input",i[4]),U(s,"submit",X(i[2]))],M=!0)},p(b,[v]){v&1&&o.value!==b[0]&&j(o,b[0]),v&2&&p.value!==b[1]&&j(p,b[1])},i:J,o:J,d(b){b&&E(e),M=!1,Y(F)}}}function pe(i,e,t){const a=Z();let n="",s="",r=new I;function c(o){a("login",{login:o})}async function h(){try{let _=await(await r.post("/system/main/login",{username:n,password:s})).json();console.log(_),_.login?(oe.set(_),await fe(_.token),await de(_.token)):alert("Credenciales inválidas"),c(_.login)}catch(o){console.trace(o),alert(o.message)}}ee(()=>{});function w(){n=this.value,t(0,n)}function y(){s=this.value,t(1,s)}return[n,s,h,w,y]}class ge extends te{constructor(e){super(),ae(this,e,pe,he,Q,{})}}export{ge as L,ce as a,le as b,ue as c,oe as d,fe as e,me as f,we as g,ye as l,I as u};
