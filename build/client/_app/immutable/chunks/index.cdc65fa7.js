import{S as re,i as ne,s as ie,k as d,q as j,a as C,l as f,m as _,r as k,h,c as D,n as l,b as oe,D as o,V as B,M as J,a4 as le,H as te,R as ce,T as ue,o as de}from"./index.4457990f.js";import{w as L}from"./index.6850ff3f.js";var ae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var R={exports:{}},se;function he(){return se||(se=1,function(n,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof ae<"u")return ae;throw new Error("unable to locate global object")},a=t();n.exports=e=a.fetch,a.fetch&&(e.default=a.fetch.bind(a)),e.Headers=a.Headers,e.Request=a.Request,e.Response=a.Response}(R,R.exports)),R.exports}let O;typeof window<"u"?O=window.fetch:O=he();class pe{constructor(e,t){this._redirect_in_unauthorized_internal=t,this._basic_authentication={},this._url=e,this._defaultHeaders=new Map}SetBasicAuthentication(e,t){return e&&t?this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"):this._basic_authentication=void 0,this}_addBasicAuthentication(e){return this._basic_authentication&&(e.Authorization=this._basic_authentication),e}addHeader(e,t){this._defaultHeaders.set(e,t)}async request(e,t,a,i){let s,r=t?t.toUpperCase():"GET",u=e&&e.length>0?e:this._url;if(!(r=="GET"||r=="POST"||r=="HEAD"||r=="PUT"||r=="DELETE"||r=="CONNECT"||r=="OPTIONS"||r=="TRACE"||r=="PATCH"))throw"Invalid method";i||(i={"Content-Type":"application/json"}),i=this._addBasicAuthentication(i);for(const[p,E]of this._defaultHeaders)i[p]=E;try{switch(r){case"POST":s=await O(u,{method:r,body:JSON.stringify(a),headers:i});break;case"PUT":s=await O(u,{method:r,body:JSON.stringify(a),headers:i});break;default:let p=new URLSearchParams(a);u=u+"?"+p.toString(),s=await O(u,{method:r,headers:i});break}return this._redirect_in_unauthorized&&s.status==401&&(window.location.href=this._redirect_in_unauthorized),s}catch(p){if(console.log(p),s)return s;throw p}}async put(e,t,a){return this.request(e,"PUT",t,a)}async delete(e,t,a){return this.request(e,"DELETE",t,a)}async post(e,t,a){return this.request(e,"POST",t,a)}async get(e,t,a){return this.request(e,"GET",t,a)}async patch(e,t,a){return this.request(e,"PATCH",t,a)}}var _e=pe;const U=fe(_e),ve=L({}),be=L({}),ye=L({}),me=L({}),He=L({}),Ie=n=>JSON.stringify(n,null,2).replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;"),qe=async(n,e)=>{let t=new U;t.addHeader("api-token",n);try{let i=await(await t.get("/system/main/functions",{appName:e})).json();if(i&&Array.isArray(i)){let s=i.map(r=>({id:r,value:r}));me.set(s)}}catch(a){console.error(a)}},we=async n=>{let e=new U;e.addHeader("api-token",n);try{let a=await(await e.get("/system/main/handlers")).json();if(a&&Array.isArray(a)){let i=a.map(s=>({id:s.handler,value:s.label,enabled:s.enabled,description:s.description}));ye.set(i)}}catch(t){console.error(t)}},ge=async n=>{let e=new U;e.addHeader("api-token",n);try{let a=await(await e.get("/system/main/methods")).json();if(a&&Array.isArray(a)){let i=a.map(s=>({id:s.method,value:s.label,enabled:s.enabled,description:""}));be.set(i)}}catch(t){console.error(t)}};function Ee(n){let e,t,a,i,s,r,u,p,E,w,c,b,g,S,V,F,A,v,M,H,I,T,G,z,$;return{c(){e=d("div"),t=d("h1"),a=j("Iniciar sesión"),i=C(),s=d("form"),r=d("div"),u=d("label"),p=j("Nombre de usuario"),E=C(),w=d("div"),c=d("input"),b=C(),g=d("div"),S=d("label"),V=j("Contraseña"),F=C(),A=d("div"),v=d("input"),M=C(),H=d("div"),I=d("div"),T=d("button"),G=j("Iniciar sesión"),this.h()},l(y){e=f(y,"DIV",{class:!0});var m=_(e);t=f(m,"H1",{class:!0});var K=_(t);a=k(K,"Iniciar sesión"),K.forEach(h),i=D(m),s=f(m,"FORM",{class:!0});var q=_(s);r=f(q,"DIV",{class:!0});var N=_(r);u=f(N,"LABEL",{class:!0});var Q=_(u);p=k(Q,"Nombre de usuario"),Q.forEach(h),E=D(N),w=f(N,"DIV",{class:!0});var W=_(w);c=f(W,"INPUT",{class:!0,type:!0,placeholder:!0}),W.forEach(h),N.forEach(h),b=D(q),g=f(q,"DIV",{class:!0});var P=_(g);S=f(P,"LABEL",{class:!0});var X=_(S);V=k(X,"Contraseña"),X.forEach(h),F=D(P),A=f(P,"DIV",{class:!0});var Y=_(A);v=f(Y,"INPUT",{class:!0,type:!0,placeholder:!0}),Y.forEach(h),P.forEach(h),M=D(q),H=f(q,"DIV",{class:!0});var Z=_(H);I=f(Z,"DIV",{class:!0});var x=_(I);T=f(x,"BUTTON",{class:!0,type:!0});var ee=_(T);G=k(ee,"Iniciar sesión"),ee.forEach(h),x.forEach(h),Z.forEach(h),q.forEach(h),m.forEach(h),this.h()},h(){l(t,"class","title is-4"),l(u,"class","label"),l(c,"class","input"),l(c,"type","text"),l(c,"placeholder","Nombre de usuario"),c.required=!0,l(w,"class","control"),l(r,"class","field"),l(S,"class","label"),l(v,"class","input"),l(v,"type","password"),l(v,"placeholder","Contraseña"),v.required=!0,l(A,"class","control"),l(g,"class","field"),l(T,"class","button is-primary"),l(T,"type","submit"),l(I,"class","control"),l(H,"class","field"),l(s,"class","form svelte-osrx57"),l(e,"class","container svelte-osrx57")},m(y,m){oe(y,e,m),o(e,t),o(t,a),o(e,i),o(e,s),o(s,r),o(r,u),o(u,p),o(r,E),o(r,w),o(w,c),B(c,n[0]),o(s,b),o(s,g),o(g,S),o(S,V),o(g,F),o(g,A),o(A,v),B(v,n[1]),o(s,M),o(s,H),o(H,I),o(I,T),o(T,G),z||($=[J(c,"input",n[3]),J(v,"input",n[4]),J(s,"submit",le(n[2]))],z=!0)},p(y,[m]){m&1&&c.value!==y[0]&&B(c,y[0]),m&2&&v.value!==y[1]&&B(v,y[1])},i:te,o:te,d(y){y&&h(e),z=!1,ce($)}}}function Te(n,e,t){const a=ue();let i="",s="",r=new U;function u(c){a("login",{login:c})}async function p(){try{let b=await(await r.post("/system/main/login",{username:i,password:s})).json();console.log(b),b.login?(ve.set(b),await ge(b.token),await we(b.token)):alert("Credenciales inválidas"),u(b.login)}catch(c){console.trace(c),alert(c.message)}}de(()=>{});function E(){i=this.value,t(0,i)}function w(){s=this.value,t(1,s)}return[i,s,p,E,w]}class Ce extends re{constructor(e){super(),ne(this,e,Te,Ee,ie,{})}}export{Ce as L,me as a,be as b,ye as c,ve as d,ge as e,Ie as f,qe as g,He as l,U as u};
