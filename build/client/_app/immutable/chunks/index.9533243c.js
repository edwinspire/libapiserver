import{s as Q,f as d,a as A,g as f,h as H,B as D,c as L,d as E,j as l,i as W,u as c,L as I,E as U,V as X,y as J,C as Y,J as Z,o as ee}from"./scheduler.009eed4a.js";import{S as te,i as ae}from"./index.cf223af7.js";import{w as O}from"./index.2058b505.js";var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function se(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var N={exports:{}},K;function ne(){return K||(K=1,function(r,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof $<"u")return $;throw new Error("unable to locate global object")},a=t();r.exports=e=a.fetch,a.fetch&&(e.default=a.fetch.bind(a)),e.Headers=a.Headers,e.Request=a.Request,e.Response=a.Response}(N,N.exports)),N.exports}let q;typeof window<"u"?q=window.fetch:q=ne();class re{constructor(e,t){this._redirect_in_unauthorized_internal=t,this._basic_authentication={},this._url=e,this._defaultHeaders=new Map}SetBasicAuthentication(e,t){return e&&t?this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"):this._basic_authentication=void 0,this}_addBasicAuthentication(e){return this._basic_authentication&&(e.Authorization=this._basic_authentication),e}addHeader(e,t){this._defaultHeaders.set(e,t)}async request(e,t,a,i){let s,n=t?t.toUpperCase():"GET",u=e&&e.length>0?e:this._url;if(!(n=="GET"||n=="POST"||n=="HEAD"||n=="PUT"||n=="DELETE"||n=="CONNECT"||n=="OPTIONS"||n=="TRACE"||n=="PATCH"))throw"Invalid method";i||(i={"Content-Type":"application/json"}),i=this._addBasicAuthentication(i);for(const[h,w]of this._defaultHeaders)i[h]=w;try{switch(n){case"POST":s=await q(u,{method:n,body:JSON.stringify(a),headers:i});break;case"PUT":s=await q(u,{method:n,body:JSON.stringify(a),headers:i});break;default:let h=new URLSearchParams(a);u=u+"?"+h.toString(),s=await q(u,{method:n,headers:i});break}return this._redirect_in_unauthorized&&s.status==401&&(window.location.href=this._redirect_in_unauthorized),s}catch(h){if(console.log(h),s)return s;throw h}}async put(e,t,a){return this.request(e,"PUT",t,a)}async delete(e,t,a){return this.request(e,"DELETE",t,a)}async post(e,t,a){return this.request(e,"POST",t,a)}async get(e,t,a){return this.request(e,"GET",t,a)}async patch(e,t,a){return this.request(e,"PATCH",t,a)}}var ie=re;const B=se(ie),oe=O({}),le=O({}),ce=O({}),ue=O({}),be=O({}),me=r=>JSON.stringify(r,null,2).replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;"),we=async(r,e)=>{let t=new B;t.addHeader("api-token",r);try{let i=await(await t.get("/system/main/functions",{appName:e})).json();if(i&&Array.isArray(i)){let s=i.map(n=>({id:n,value:n}));ue.set(s)}}catch(a){console.error(a)}},de=async r=>{let e=new B;e.addHeader("api-token",r);try{let a=await(await e.get("/system/main/handlers")).json();if(a&&Array.isArray(a)){let i=a.map(s=>({id:s.handler,value:s.label,enabled:s.enabled,description:s.description}));ce.set(i)}}catch(t){console.error(t)}},fe=async r=>{let e=new B;e.addHeader("api-token",r);try{let a=await(await e.get("/system/main/methods")).json();if(a&&Array.isArray(a)){let i=a.map(s=>({id:s.method,value:s.label,enabled:s.enabled,description:""}));le.set(i)}}catch(t){console.error(t)}};function he(r){let e,t,a="Iniciar sesión",i,s,n,u,h="Nombre de usuario",w,b,o,_,m,g,V="Contraseña",k,T,p,R,C,x='<div class="control"><button class="button is-primary" type="submit">Iniciar sesión</button></div>',M,F;return{c(){e=d("div"),t=d("h1"),t.textContent=a,i=A(),s=d("form"),n=d("div"),u=d("label"),u.textContent=h,w=A(),b=d("div"),o=d("input"),_=A(),m=d("div"),g=d("label"),g.textContent=V,k=A(),T=d("div"),p=d("input"),R=A(),C=d("div"),C.innerHTML=x,this.h()},l(v){e=f(v,"DIV",{class:!0});var y=H(e);t=f(y,"H1",{class:!0,"data-svelte-h":!0}),D(t)!=="svelte-1yeihy2"&&(t.textContent=a),i=L(y),s=f(y,"FORM",{class:!0});var S=H(s);n=f(S,"DIV",{class:!0});var P=H(n);u=f(P,"LABEL",{class:!0,"data-svelte-h":!0}),D(u)!=="svelte-1tq2mwz"&&(u.textContent=h),w=L(P),b=f(P,"DIV",{class:!0});var z=H(b);o=f(z,"INPUT",{class:!0,type:!0,placeholder:!0}),z.forEach(E),P.forEach(E),_=L(S),m=f(S,"DIV",{class:!0});var j=H(m);g=f(j,"LABEL",{class:!0,"data-svelte-h":!0}),D(g)!=="svelte-66z98u"&&(g.textContent=V),k=L(j),T=f(j,"DIV",{class:!0});var G=H(T);p=f(G,"INPUT",{class:!0,type:!0,placeholder:!0}),G.forEach(E),j.forEach(E),R=L(S),C=f(S,"DIV",{class:!0,"data-svelte-h":!0}),D(C)!=="svelte-u84jsi"&&(C.innerHTML=x),S.forEach(E),y.forEach(E),this.h()},h(){l(t,"class","title is-4"),l(u,"class","label"),l(o,"class","input"),l(o,"type","text"),l(o,"placeholder","Nombre de usuario"),o.required=!0,l(b,"class","control"),l(n,"class","field"),l(g,"class","label"),l(p,"class","input"),l(p,"type","password"),l(p,"placeholder","Contraseña"),p.required=!0,l(T,"class","control"),l(m,"class","field"),l(C,"class","field"),l(s,"class","form svelte-osrx57"),l(e,"class","container svelte-osrx57")},m(v,y){W(v,e,y),c(e,t),c(e,i),c(e,s),c(s,n),c(n,u),c(n,w),c(n,b),c(b,o),I(o,r[0]),c(s,_),c(s,m),c(m,g),c(m,k),c(m,T),c(T,p),I(p,r[1]),c(s,R),c(s,C),M||(F=[U(o,"input",r[3]),U(p,"input",r[4]),U(s,"submit",X(r[2]))],M=!0)},p(v,[y]){y&1&&o.value!==v[0]&&I(o,v[0]),y&2&&p.value!==v[1]&&I(p,v[1])},i:J,o:J,d(v){v&&E(e),M=!1,Y(F)}}}function pe(r,e,t){const a=Z();let i="",s="",n=new B;function u(o){a("login",{login:o})}async function h(){try{let _=await(await n.post("/system/main/login",{username:i,password:s})).json();console.log(_),_.login?(oe.set(_),await fe(_.token),await de(_.token)):alert("Credenciales inválidas"),u(_.login)}catch(o){console.trace(o),alert(o.message)}}ee(()=>{});function w(){i=this.value,t(0,i)}function b(){s=this.value,t(1,s)}return[i,s,h,w,b]}class ge extends te{constructor(e){super(),ae(this,e,pe,he,Q,{})}}export{ge as L,ue as a,le as b,ce as c,oe as d,fe as e,me as f,we as g,be as l,B as u};
