import{s as Q,f as c,a as H,g as f,h as S,B as P,c as B,d as E,j as l,i as W,u,L as j,E as U,V as X,y as J,C as Y,J as Z,o as ee}from"./scheduler.009eed4a.js";import{S as te,i as ae}from"./index.cf223af7.js";import{w as q}from"./index.2058b505.js";var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ne(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var D={exports:{}},K;function se(){return K||(K=1,function(i,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof $<"u")return $;throw new Error("unable to locate global object")},a=t();i.exports=e=a.fetch,a.fetch&&(e.default=a.fetch.bind(a)),e.Headers=a.Headers,e.Request=a.Request,e.Response=a.Response}(D,D.exports)),D.exports}let L;typeof window<"u"?L=window.fetch:L=se();class ie{constructor(e=void 0,t=void 0){this._redirect_in_unauthorized_internal=t,this._basic_authentication={},this._bearer_authentication,this._url=e,this._defaultHeaders=new Map}SetBasicAuthentication(e,t){return e&&t?this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"):this._basic_authentication=void 0,this}setBasicAuthorization(e,t){return e&&t?this._basic_authentication="Basic "+Buffer.from(e+":"+t).toString("base64"):this._basic_authentication=void 0,this}setBearerAuthorization(e){return e?this._bearer_authentication="Bearer "+e:this._bearer_authentication=void 0,this}_addAuthorizationHeader(e){return this._basic_authentication&&(e.Authorization=this._basic_authentication),this._bearer_authentication&&(e.Authorization=this._bearer_authentication),e}addHeader(e,t){this._defaultHeaders.set(e,t)}async request(e,t,a,r){let n,s=t?t.toUpperCase():"GET",d=e&&e.length>0?e:this._url;if(!(s=="GET"||s=="POST"||s=="HEAD"||s=="PUT"||s=="DELETE"||s=="CONNECT"||s=="OPTIONS"||s=="TRACE"||s=="PATCH"))throw"Invalid method";r||(r={"Content-Type":"application/json"}),r=this._addAuthorizationHeader(r);for(const[h,w]of this._defaultHeaders)r[h]=w;try{switch(s){case"POST":n=await L(d,{method:s,body:JSON.stringify(a),headers:r});break;case"PUT":n=await L(d,{method:s,body:JSON.stringify(a),headers:r});break;default:let h=new URLSearchParams(a);d=d+"?"+h.toString(),n=await L(d,{method:s,headers:r});break}return this._redirect_in_unauthorized&&n.status==401&&(window.location.href=this._redirect_in_unauthorized),n}catch(h){if(console.log(h),n)return n;throw h}}async put(e=void 0,t=void 0,a=void 0){return this.request(e,"PUT",t,a)}async delete(e=void 0,t=void 0,a=void 0){return this.request(e,"DELETE",t,a)}async post(e=void 0,t=void 0,a=void 0){return this.request(e,"POST",t,a)}async get(e=void 0,t=void 0,a=void 0){return this.request(e,"GET",t,a)}async patch(e=void 0,t=void 0,a=void 0){return this.request(e,"PATCH",t,a)}}var re=ie;const I=ne(re),oe=q({}),le=q({}),ue=q({}),de=q({}),ye=q({}),me=i=>JSON.stringify(i,null,2).replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;"),we=async(i,e)=>{let t=new I;t.setBearerAuthorization(i);try{let r=await(await t.get("/system/main/functions",{appName:e})).json();if(r&&Array.isArray(r)){let n=r.map(s=>({id:s,value:s}));de.set(n)}}catch(a){console.error(a)}},ce=async i=>{let e=new I;e.setBearerAuthorization(i);try{let a=await(await e.get("/system/main/handlers")).json();if(a&&Array.isArray(a)){let r=a.map(n=>({id:n.handler,value:n.label,enabled:n.enabled,description:n.description}));ue.set(r)}}catch(t){console.error(t)}},fe=async i=>{let e=new I;e.setBearerAuthorization(i);try{let a=await(await e.get("/system/main/methods")).json();if(a&&Array.isArray(a)){let r=a.map(n=>({id:n.method,value:n.label,enabled:n.enabled,description:""}));le.set(r)}}catch(t){console.error(t)}};function he(i){let e,t,a="Iniciar sesión",r,n,s,d,h="Nombre de usuario",w,y,o,_,m,g,V="Contraseña",N,A,p,R,C,x='<div class="control"><button class="button is-primary" type="submit">Iniciar sesión</button></div>',M,F;return{c(){e=c("div"),t=c("h1"),t.textContent=a,r=H(),n=c("form"),s=c("div"),d=c("label"),d.textContent=h,w=H(),y=c("div"),o=c("input"),_=H(),m=c("div"),g=c("label"),g.textContent=V,N=H(),A=c("div"),p=c("input"),R=H(),C=c("div"),C.innerHTML=x,this.h()},l(b){e=f(b,"DIV",{class:!0});var v=S(e);t=f(v,"H1",{class:!0,"data-svelte-h":!0}),P(t)!=="svelte-1yeihy2"&&(t.textContent=a),r=B(v),n=f(v,"FORM",{class:!0});var T=S(n);s=f(T,"DIV",{class:!0});var z=S(s);d=f(z,"LABEL",{class:!0,"data-svelte-h":!0}),P(d)!=="svelte-1tq2mwz"&&(d.textContent=h),w=B(z),y=f(z,"DIV",{class:!0});var k=S(y);o=f(k,"INPUT",{class:!0,type:!0,placeholder:!0}),k.forEach(E),z.forEach(E),_=B(T),m=f(T,"DIV",{class:!0});var O=S(m);g=f(O,"LABEL",{class:!0,"data-svelte-h":!0}),P(g)!=="svelte-66z98u"&&(g.textContent=V),N=B(O),A=f(O,"DIV",{class:!0});var G=S(A);p=f(G,"INPUT",{class:!0,type:!0,placeholder:!0}),G.forEach(E),O.forEach(E),R=B(T),C=f(T,"DIV",{class:!0,"data-svelte-h":!0}),P(C)!=="svelte-u84jsi"&&(C.innerHTML=x),T.forEach(E),v.forEach(E),this.h()},h(){l(t,"class","title is-4"),l(d,"class","label"),l(o,"class","input"),l(o,"type","text"),l(o,"placeholder","Nombre de usuario"),o.required=!0,l(y,"class","control"),l(s,"class","field"),l(g,"class","label"),l(p,"class","input"),l(p,"type","password"),l(p,"placeholder","Contraseña"),p.required=!0,l(A,"class","control"),l(m,"class","field"),l(C,"class","field"),l(n,"class","form svelte-osrx57"),l(e,"class","container svelte-osrx57")},m(b,v){W(b,e,v),u(e,t),u(e,r),u(e,n),u(n,s),u(s,d),u(s,w),u(s,y),u(y,o),j(o,i[0]),u(n,_),u(n,m),u(m,g),u(m,N),u(m,A),u(A,p),j(p,i[1]),u(n,R),u(n,C),M||(F=[U(o,"input",i[3]),U(p,"input",i[4]),U(n,"submit",X(i[2]))],M=!0)},p(b,[v]){v&1&&o.value!==b[0]&&j(o,b[0]),v&2&&p.value!==b[1]&&j(p,b[1])},i:J,o:J,d(b){b&&E(e),M=!1,Y(F)}}}function pe(i,e,t){const a=Z();let r="",n="",s=new I;function d(o){a("login",{login:o})}async function h(){try{let _=await(await s.post("/system/main/login",{username:r,password:n})).json();console.log(_),_.login?(oe.set(_),await fe(_.token),await ce(_.token)):alert("Credenciales inválidas"),d(_.login)}catch(o){console.trace(o),alert(o.message)}}ee(()=>{});function w(){r=this.value,t(0,r)}function y(){n=this.value,t(1,n)}return[r,n,h,w,y]}class ge extends te{constructor(e){super(),ae(this,e,pe,he,Q,{})}}export{ge as L,de as a,le as b,$ as c,ue as d,I as e,me as f,ne as g,we as h,fe as i,ye as l,oe as u};
